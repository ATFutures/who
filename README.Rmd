---
title: "Estimating cycling potential on the route network in Accra and Kathmandu: a feasibility study using open data and open source software"
# output:
#   md_document:
#     variant: markdown_github
author: Robin Lovelace and Mark Padgham
date: '`r Sys.Date()`'
bibliography: who.bib
# output:
#   pdf_document:
#     number_sections: yes
---

<!-- Note: this is where I'm adding the write-up for now for maximum visibility.
Can go elsewhere, e.g. as a vignette before this is open sourced. -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  out.width = "100%",
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-",
  echo = FALSE
)
# add citation
# citr::tidy_bib_file(rmd_file = "README.Rmd", messy_bibliography = "~/allrefs.bib", file = "who.bib")
```

# Introduction

With mounting evidence of health [@celis-morales_association_2017], environmental and social benefits of active travel, many cities are preparing ambitious walking and cycling plans.
However many transport authorities lack strong and actionable evidence to support this investment for a number of reasons, including:

- transport models have tended to focus on motor vehicles [@boyce_forecasting_2015]
- data on active travel tends to be sparse and inaccessible [@kuzmyak_estimating_2014]
- data and models that are available tend to be unavailable for many potential stakeholders (e.g. civil society groups) and in a format that is difficult to understand and use [@naess_transport_2014]

This project aims to tackle these problems by assessing the feasibility of tools to provide *actionable*, *publicly accessible* and *geographically detailed* evidence to prioritise investment in cycling for the case study cities of Accra and Kathmandu.

This document represents an *interim report* on progress during the first week of this month-long project, which commenced on 18^th^ December 2017.

# Input data

Data were accessed from the following sources:

- Transport network and building data from **OpenStreetMap (OSM)**, an open access, freely available, crowd-sourced online mapping database [@barrington-leigh_worlds_2017].
- Population density and some demographic data from [worldpop](http://www.worldpop.org.uk/) [@tatem_worldpop_2017]
<!-- - Topographic data from NASA's open SRTM data -->

<!-- Additional data on population densities will be obtained from WorldPop and from NASA's Socioeconomic Data and Applications Center (SDAC). The -->
<!-- former provides static fine-resolution data (100$m^2$, for the year 2013 only), while the latter provides coarser (1$km^2$) future projections -->
<!-- out to 2020. -->

# Methods

We have made a number of technical breakthroughs that allow us to estimate cycling potential down to the road network level based on open data.
This involved implementing a highly computationally efficient routing algorithm in C++.
Since commencing the project we have developed a method for re-allocating the results of the routing algorithm back onto the road network.
A custom level of road segmentation was developed to create this geographical aggregated flow map, which clearly shows routes with high cycling potential ([see interactive version](http://rpubs.com/RobinLovelace/341996)):

```{r, echo=FALSE, fig.cap="Illustration of interactive map demonstrating the preliminary results: the routes in Accra with highest cycling potential."}
knitr::include_graphics("fig/accra-flow1-interactive.png")
```

# City overviews

This section provides a high-level overview about the geography of each city as it relates to active travel potential.
Both cities are included in this section, laying the ground for the next two sections which provide detailed results for Accra and then Kathmandu.
Comparing the cities at the outset will help put the results in perspective and lay the foundation for a discussion of how a tool building on this work could be useful to different stakeholders in each city.

Accra is the larger city, with a population approaching 5 million and a growth rate of around 3% per year in the Greater Accra Region according to the [Ghana Statistical Service](http://www.statsghana.gov.gh/docfiles/2010phc/Projected%20population%20by%20sex%202010%20-%202016.pdf).
Kathmandu has a population of just over 1.2 million, according to the [World Population Review](http://worldpopulationreview.com/world-cities/kathmandu-population/).

We already have some results from the OSM and demographic datasets, as outlined below.

\newpage

## OpenStreetMap data

The OpenStreetMap network for Accra has 145,827 street segments connecting
131,349 distinct points, and extends over 4,072km. The OSM data also include
24,490 buildings, of which 23,102 include geometric descriptions only, while the
remaining 1,388 buildings are divided between 28 distinct categories.

The equivalent network for Kathmandu has 79,832 street segments connecting
37,770 distinct points, and extends over 1,062km. The OSM data also include 82,333
buildings of which 75,778 include geometric descriptions only, while the
remaining 6,555 are divided between 344 distinct categories (in this case
including many named buildings).

```{r, echo=FALSE}
r = readRDS("extdata/r.rds")
names(r) = c("City", "Street nodes", "Street segments", "Network distance (km)", "Population (on network)", "N. Buildings", "nb_no_desc", "Num. Building Classes")
knitr::kable(r[c(1, 5, 6, 8)], caption = "Basic OSM characteristics of case study cities")
```


The street network for Accra is more extensive, reflecting the greater spatial
extent of the city, while data on buildings are considerable more detailed for
Kathmandu than for Accra, presumably reflecting extensive humanitarian mapping
activity in response to the 2015 earthquake.

```{r}
knitr::kable(r[1:4], caption = "Characteristics of OSM route network data for case study cities.")
```


## Demographic data

Demographic data for Accra from worldpop include population density estimates
at 172,238 points, corresponding to estimates in roughly 30-by-30m grid cells.
Estimates are available for total population density, as well as distributed
between 14 5-year age classes from 0-5 years up to 60-65 years, and 65+ years.

Demographic data for Kathmandu are not as detailed, and also do not include age
classes.

## An overview of Accra from an active travel perspective

<!-- Monsuru (1 day's work) -->
<!-- This section will provide background information on the following topics: -->

<!-- - Institutions working in transport and their aims -->
<!-- - References about the transport system in Accra -->
<!-- - Photos of current set-up -->
<!-- - What is the current modal split? -->
<!-- - Recent transport policies. -->
<!-- - How well developed are other infrastructures (e.g. sewerage.) -->



### Greater Accra Metropolitan Area (GAMA)

The Greater Accra Metropolitan Area, simply referred to as Accra city, is the smallest geographical region of Ghana’s 10 administrative regions, covering only 1.4 percent of the total land area of Ghana (see Fig. xx). It is the second most populous region, after the Ashanti region. According to the Ghana Statistical Service, Accra city’s population is estimated to be approaching 5 million, with a growth rate of around 3% per year. Fifty six percent of the population is estimated to be under 24 years of age, with fifty-one percent (51%) of the population being females, and the remaining 49% males, giving a male-to-female ratio of 1:1.04. 

```{r, fig.cap="Geographical location of Greater Accra Metropolitan Area (GAMA)"}
knitr::include_graphics("fig/study-area-accra.png")
```

 
Accra city comprises 10 of the 216 local authority districts of the Republic of Ghana. Administratively, the Accra Metropolitan local authority district serves as the capital of Accra city, and is administered by Accra Metropolitan Assembly, which is the political and administrative authority for the entire Accra city. 



[@quarshie_integrating_2007]


## An overview of Kathmandu from an active travel perspective

This section will provide background information on the following topics:

- Institutions working in transport and their aims
- References about the transport system in Accra
- Photos of current set-up
- What is the current modal split?
- Recent transport policies.
- How well developed are other infrastructures (e.g. sewerage.)

# Results I: Accra

This section is work in progress.
We will explore how well the OSM road network illustrated in the map below represents the true state of the transport system.

```{r, fig.cap="Overview of Accra (left) and initial results of cycling potential (right).", fig.show='hold', out.width="49%"}
knitr::include_graphics(c("fig/accra-osm-overview.png", "fig/test.png"))
```

We have generated estimates for cycling potential across the larger of the two case study cities. The priority over the next 3 weeks of the project will be to calibrate this model and apply refined versions of it to both cities, using additional input datasets where available.

# Results II: Kathmandu

This section is work in progress.

# Validation and calibration

This section is work in progress.

# Discussion

This section is work in progress.

## Policy relevance of results

<!-- To what extent has this deliverable (from phase 1) been delivered? -->
<!-- **Deliverables:** This phase will provide clean datasets and summary information about the 'data landscape' of each case study city. -->
<!-- This will relate primarily to population density, trip attractors and transport infrastructure from which to -->
<!-- We will also deliver summaries of the relationships between demographic and transport infrastructure data and an assessment of the quality of local data and priorities for future data collection. -->
<!-- The deliverables will be provided in the form of datasets provided to the WHO and interactive and high quality maps. -->

## The potential uses of an online toolkit

# Next steps

This section is work in progress.

# References

<!-- Anything else to consider here guys? -->


